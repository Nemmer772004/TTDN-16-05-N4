<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Search View - Filters & Comparisons -->
        <record id="view_bao_cao_su_dung_phong_search" model="ir.ui.view">
            <field name="name">bao_cao.su.dung.phong.search</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <search string="T√¨m ki·∫øm b√°o c√°o">
                    <field name="phong_id"/>
                    <field name="nguoi_muon_id"/>
                    <field name="ngay"/>
                    
                    <!-- Filters theo th·ªùi gian -->
                    <filter string="Th√°ng n√†y" name="filter_thang_nay" 
                        domain="[('ngay', '&gt;=', (context_today() - relativedelta(day=1)).strftime('%%Y-%%m-%%d')), 
                                ('ngay', '&lt;=', (context_today() + relativedelta(months=1, day=1, days=-1)).strftime('%%Y-%%m-%%d'))]"/>
                    
                    <filter string="Th√°ng tr∆∞·ªõc" name="filter_thang_truoc" 
                        domain="[('ngay', '&gt;=', (context_today() - relativedelta(months=1, day=1)).strftime('%%Y-%%m-%%d')), 
                                ('ngay', '&lt;=', (context_today() - relativedelta(day=1, days=1)).strftime('%%Y-%%m-%%d'))]"/>
                    
                    <filter string="Qu√Ω n√†y" name="filter_quy_nay" 
                        domain="[('ngay', '&gt;=', (context_today() - relativedelta(day=1, month=(((context_today().month-1)//3)*3)+1)).strftime('%%Y-%%m-%%d')), 
                                ('ngay', '&lt;=', context_today().strftime('%%Y-%%m-%%d'))]"/>
                    
                    <filter string="NƒÉm nay" name="filter_nam_nay" 
                        domain="[('ngay', '&gt;=', context_today().strftime('%%Y-01-01')), 
                                ('ngay', '&lt;=', context_today().strftime('%%Y-12-31'))]"/>
                    
                    <separator/>
                    
                    <!-- Filters theo ƒë√°nh gi√° -->
                    <filter string="ƒê√°nh gi√° t·ªët (‚â•4)" name="filter_danh_gia_tot" 
                        domain="[('trung_binh_danh_gia', '&gt;=', 4)]"/>
                    
                    <filter string="ƒê√°nh gi√° TB (2-4)" name="filter_danh_gia_tb" 
                        domain="[('trung_binh_danh_gia', '&gt;=', 2), ('trung_binh_danh_gia', '&lt;', 4)]"/>
                    
                    <separator/>
                    
                    <!-- Group by -->
                    <group expand="1" string="Nh√≥m theo">
                        <filter string="Ph√≤ng" name="group_phong" context="{'group_by': 'phong_id'}"/>
                        <filter string="Ng∆∞·ªùi m∆∞·ª£n" name="group_nguoi_muon" context="{'group_by': 'nguoi_muon_id'}"/>
                        <separator/>
                        <filter string="Ng√†y" name="group_ngay" context="{'group_by': 'ngay:day'}"/>
                        <filter string="Tu·∫ßn" name="group_tuan" context="{'group_by': 'ngay:week'}"/>
                        <filter string="Th√°ng" name="group_thang" context="{'group_by': 'ngay:month'}"/>
                        <filter string="Qu√Ω" name="group_quy" context="{'group_by': 'ngay:quarter'}"/>
                        <filter string="NƒÉm" name="group_nam" context="{'group_by': 'ngay:year'}"/>
                    </group>
                    
                    <!-- Comparison -->
                    <group expand="0" string="So s√°nh">
                        <filter string="So s√°nh: Th√°ng tr∆∞·ªõc" name="comparison_thang_truoc" 
                            context="{'comparison_menu': True, 'comparison_range': 'previous_month'}"/>
                        <filter string="So s√°nh: C√πng k·ª≥ nƒÉm tr∆∞·ªõc" name="comparison_nam_truoc" 
                            context="{'comparison_menu': True, 'comparison_range': 'previous_year'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Pivot View -->
        <record id="view_bao_cao_su_dung_phong_pivot" model="ir.ui.view">
            <field name="name">bao_cao.su.dung.phong.pivot</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <pivot string="B√°o c√°o s·ª≠ d·ª•ng ph√≤ng" sample="1">
                    <field name="phong_id" type="row"/>
                    <field name="ngay" interval="month" type="col"/>
                    <field name="so_lan_su_dung" type="measure"/>
                    <field name="tong_thoi_gian_gio" type="measure"/>
                    <field name="tong_chi_phi" type="measure"/>
                    <field name="trung_binh_danh_gia" type="measure"/>
                </pivot>
            </field>
        </record>

        <!-- Graph View - LINE Chart for Time Series -->
        <record id="view_bao_cao_su_dung_phong_graph" model="ir.ui.view">
            <field name="name">bao.cao.su.dung.phong.graph</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <graph string="üìà Xu h∆∞·ªõng s·ª≠ d·ª•ng ph√≤ng theo th·ªùi gian" type="line" sample="1" order="asc">
                    <field name="ngay" interval="day"/>
                    <field name="phong_id" type="row"/>
                    <field name="tong_thoi_gian_gio" type="measure"/>
                    <field name="so_lan_su_dung" type="measure"/>
                </graph>
            </field>
        </record>

        <!-- Graph View 2 - Bar Chart for Comparison -->
        <record id="view_bao_cao_su_dung_phong_graph_bar" model="ir.ui.view">
            <field name="name">bao.cao.su.dung.phong.graph.bar</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <graph string="üìä So s√°nh gi·ªØa c√°c ph√≤ng" type="bar" stacked="False" sample="1">
                    <field name="phong_id"/>
                    <field name="tong_thoi_gian_gio" type="measure"/>
                    <field name="tong_chi_phi" type="measure"/>
                    <field name="so_lan_su_dung" type="measure"/>
                </graph>
            </field>
        </record>

        <!-- Graph View 3 - LINE Chart Monthly Trend (Easier to read) -->
        <record id="view_bao_cao_su_dung_phong_graph_monthly" model="ir.ui.view">
            <field name="name">bao.cao.su.dung.phong.graph.monthly</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <graph string="üìà Xu h∆∞·ªõng theo th√°ng (nhi·ªÅu m√†u)" type="line" sample="1" order="asc">
                    <field name="ngay" interval="month"/>
                    <field name="phong_id" type="row"/>
                    <field name="tong_thoi_gian_gio" type="measure"/>
                    <field name="tong_chi_phi" type="measure"/>
                    <field name="so_lan_su_dung" type="measure"/>
                </graph>
            </field>
        </record>

        <!-- Tree View -->
        <record id="view_bao_cao_su_dung_phong_tree" model="ir.ui.view">
            <field name="name">bao_cao.su_dung_phong.tree</field>
            <field name="model">bao_cao_su_dung_phong</field>
            <field name="arch" type="xml">
                <tree string="B√°o c√°o s·ª≠ d·ª•ng ph√≤ng" sample="1" 
                      decoration-success="trung_binh_danh_gia &gt;= 4"
                      decoration-warning="trung_binh_danh_gia &gt;= 2 and trung_binh_danh_gia &lt; 4"
                      decoration-danger="trung_binh_danh_gia &lt; 2">
                    <field name="ngay"/>
                    <field name="phong_id"/>
                    <field name="nguoi_muon_id"/>
                    <field name="so_lan_su_dung" sum="T·ªïng"/>
                    <field name="tong_thoi_gian_gio" sum="T·ªïng gi·ªù" widget="float_time"/>
                    <field name="tong_chi_phi" sum="T·ªïng chi ph√≠" widget="monetary"/>
                    <field name="trung_binh_danh_gia" avg="Trung b√¨nh" widget="progressbar"/>
                </tree>
            </field>
        </record>

        <!-- Action -->
        <record id="action_bao_cao_su_dung_phong" model="ir.actions.act_window">
            <field name="name">üìà B√°o c√°o &amp; Ph√¢n t√≠ch s·ª≠ d·ª•ng ph√≤ng</field>
            <field name="res_model">bao_cao_su_dung_phong</field>
            <field name="view_mode">graph,pivot,tree</field>
            <field name="context">{
                'search_default_filter_thang_nay': 1,
                'search_default_group_ngay': 1,
                'search_default_group_phong': 1
            }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    üìä Ch∆∞a c√≥ d·ªØ li·ªáu b√°o c√°o
                </p>
                <p>
                    B√°o c√°o s·∫Ω hi·ªÉn th·ªã sau khi c√≥ ph√≤ng ƒë∆∞·ª£c tr·∫£.<br/>
                    <b>T√≠nh nƒÉng:</b><br/>
                    ‚Ä¢ Bi·ªÉu ƒë·ªì ƒë∆∞·ªùng: Theo d√µi xu h∆∞·ªõng theo th·ªùi gian<br/>
                    ‚Ä¢ Bi·ªÉu ƒë·ªì c·ªôt: So s√°nh gi·ªØa c√°c ph√≤ng<br/>
                    ‚Ä¢ B·∫£ng t·ªïng h·ª£p: Xem chi ti·∫øt t·ª´ng kho·∫£n<br/>
                    ‚Ä¢ Filters: L·ªçc theo th·ªùi gian, ƒë√°nh gi√°<br/>
                    ‚Ä¢ So s√°nh: V·ªõi k·ª≥ tr∆∞·ªõc, nƒÉm tr∆∞·ªõc
                </p>
            </field>
        </record>
    </data>
</odoo>
